# More Geometry of Vectors

## Angle Betwen Two Vectors

There is a relationship between the inner product of two vectors and the angle between them. Namely,

$$
\mathbf{a} \bullet \mathbf{b} = \lvert\lvert\mathbf{a}\rvert\rvert ~ \lvert\lvert\mathbf{b}\rvert\rvert \cos(\theta)
$$

where $\lvert\lvert\mathbf{a}\rvert\rvert$ and $\lvert\lvert\mathbf{b}\rvert\rvert$ are the lengths of vectors **a** and **b** and $\theta$ is the angle between them (see Figure \@ref(fig:fig)5).

```{r fig05, echo=FALSE, fig.width=6, fig.height = 6, out.width='80%', fig.cap="Plot showing vector **a** (in red) and vector **b** (in blue) in the R1--R2 dimensional space. For convenience we have located each vector at the origin. The angle between the vectors is denoted $\theta$."}
graph_paper +
  geom_curve(x = 1/3, y = 0.5, xend = -0.5, yend = 0.125, curvature = 0.3, color = "#48556C") +
  geom_segment(x = 0, xend = 2, y = 0, yend = 3, color = "#FF2D21",
    arrow = arrow(length = unit(0.02, "npc"), end = "last", type = "closed")
  ) +
  geom_segment(x = 0, xend = -4, y = 0, yend = 1, color = "#1A5C71",
    arrow = arrow(length = unit(0.02, "npc"), end = "last", type = "closed")
  ) +
#  geom_segment(x = 2, xend = -4, y = 3, yend = 1,color = "#48556C") +
  annotate("text", x = 13.5, y = -0.5, label = "R1", size = 4) +
  annotate("text", x = 0.65, y = 13.5, label = "R2", size = 4) +
  annotate("text", x = -0.4, y = 0.7, label = "theta", size = 4, color = "#48556C", parse = TRUE) +
  annotate("text", x = 1.3, y = 1.0, label = "||a||", size = 4, color = "#FF2D21") +
  annotate("text", x = -2.5, y = 0.2, label = "||b||", size = 4, color = "#1A5C71")
```

In this example,

$$
\mathbf{a} = \begin{bmatrix}
2 \\ 3
\end{bmatrix} \qquad \mathbf{b} = \begin{bmatrix}
-4 \\ 1
\end{bmatrix}
$$

Then

$$
\begin{split}
\mathbf{a} \bullet \mathbf{b} &= \lvert\lvert\mathbf{a}\rvert\rvert ~ \lvert\lvert\mathbf{b}\rvert\rvert \cos(\theta) \\[2ex]
-5 &= \sqrt{13} \sqrt{17} \cos(\theta) \\[2ex]
\frac{-5}{\sqrt{13} \sqrt{17}} &= \cos(\theta)
\end{split}
$$

Computing the arc-cosine we find that $\theta=1.914$ radians ($109.6^\circ$).

```{r}
# Find theta (radians)
acos(-5 / (sqrt(13) * sqrt(17)))

# Find theta (degrees)
acos(-5 / (sqrt(13) * sqrt(17))) * 180 / pi
```


We can also determine the angle between two vectors by using the [law of cosines](https://en.wikipedia.org/wiki/Law_of_cosines), which is a generalization of the Pythagorean Theorem. The cosine law relates the lengths of the sides of a triangle to the cosine of one of its angles. Consider the following triangle formed by connecting the terminuses of two vectors that both originate from the origin:

The law of cosines says:

$$
\begin{split}
a^{2}&=b^{2}+c^{2}-2bc \cos(\alpha) \\[2ex]
b^{2}&=a^{2}+c^{2}-2ac \cos(\beta) \\[2ex]
c^{2}&=a^{2}+b^{2}-2ab \cos(\gamma) \\[2ex]
\end{split}
$$

